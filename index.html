<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aplikacja do nauki s≈Çownictwa angielskiego na poziomie B1/B2">
    <meta name="theme-color" content="#1e3a8a">
    <title>English Flashcards B1/B2</title>
    
    <!-- Critical CSS - inline dla szybkiego ≈Çadowania -->
    <style>
        :root{--blue-50:#eff6ff;--blue-100:#dbeafe;--blue-200:#bfdbfe;--blue-300:#93c5fd;--blue-400:#60a5fa;--blue-500:#3b82f6;--blue-600:#2563eb;--blue-700:#1d4ed8;--blue-800:#1e40af;--blue-900:#1e3a8a;--gray-50:#f9fafb;--gray-100:#f3f4f6;--gray-200:#e5e7eb;--gray-300:#d1d5db;--gray-400:#9ca3af;--gray-500:#6b7280;--gray-600:#4b5563;--gray-700:#374151;--gray-800:#1f2937;--gray-900:#111827;--green-400:#4ade80;--green-500:#22c55e;--red-400:#f87171;--red-500:#ef4444;--yellow-400:#facc15;--yellow-500:#eab308;--gradient-primary:linear-gradient(135deg,var(--blue-600),var(--blue-800));--gradient-secondary:linear-gradient(135deg,var(--gray-100),var(--gray-200));--shadow-sm:0 1px 2px 0 rgba(0,0,0,0.05);--shadow:0 1px 3px 0 rgba(0,0,0,0.1),0 1px 2px 0 rgba(0,0,0,0.06);--shadow-md:0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06);--shadow-lg:0 10px 15px -3px rgba(0,0,0,0.1),0 4px 6px -2px rgba(0,0,0,0.05);--shadow-xl:0 20px 25px -5px rgba(0,0,0,0.1),0 10px 10px -5px rgba(0,0,0,0.04);--radius-none:0;--radius-sm:0.125rem;--radius:0.25rem;--radius-md:0.375rem;--radius-lg:0.5rem;--radius-xl:0.75rem;--radius-2xl:1rem;--radius-full:9999px}
        *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
        html{font-size:16px;scroll-behavior:smooth}
        body{font-family:system-ui,-apple-system,sans-serif;background:var(--gradient-primary);min-height:100vh;color:var(--gray-900)}
        body.loading{overflow:hidden}
        .loading-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:var(--gradient-primary);display:flex;align-items:center;justify-content:center;z-index:9999;opacity:1;transition:opacity 0.3s}
        .loading-content{text-align:center;color:white}
        .loading-spinner{width:40px;height:40px;border:3px solid rgba(255,255,255,0.3);border-top:3px solid #fff;border-radius:50%;animation:spin 1s linear infinite;margin:1.5rem auto}
        @keyframes spin{to{transform:rotate(360deg)}}
        .app-container{min-height:100vh}
        .container{max-width:1200px;margin:0 auto;padding:0 1rem}
        .hidden{display:none!important}
    </style>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="css/main.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="js/app.js" as="script">
    
    <!-- Non-critical CSS -->
    <link rel="stylesheet" href="css/themes.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="css/components.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="css/responsive.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" href="css/difficulty-styles.css" media="print" onload="this.media='all'">
    <!-- Image Modal Styles -->
    <link rel="stylesheet" href="css/image-modal.css" media="print" onload="this.media='all'">
    
    <!-- Fallback for no-JS -->
    <noscript>
        <link rel="stylesheet" href="css/main.css">
        <link rel="stylesheet" href="css/difficulty-styles.css">
        <link rel="stylesheet" href="css/themes.css">
        <link rel="stylesheet" href="css/components.css">
        <link rel="stylesheet" href="css/responsive.css">
        <link rel="stylesheet" href="css/3d-fixes.css">
        <link rel="stylesheet" href="css/image-modal.css">
        
    </noscript>
</head>
<body class="loading">
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo" style="font-size:3rem;margin-bottom:1rem;animation:pulse 2s infinite">üá¨üáß</div>
            <h2 style="font-size:1.5rem;font-weight:bold;margin-bottom:1.5rem;text-shadow:0 2px 4px rgba(0,0,0,0.3)">English Flashcards B1/B2</h2>
            <div class="loading-spinner"></div>
            <p id="loading-message" style="font-size:1.125rem;opacity:0.9">≈Åadowanie aplikacji...</p>
        </div>
    </div>

    <!-- Main Application Container -->
    <div id="app" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="container">
                <div class="header-content">
                    <div class="logo-section">
                        <h1>
                            <span class="flag">üá¨üáß</span>
                            English B1/B2
                            <span class="flag">üá∫üá∏</span>
                        </h1>
                        <p class="subtitle">1600+ s≈Ç√≥w w 32 kategoriach</p>
                    </div>
                    
                    <!-- Header Controls -->
                    <div class="header-controls">
                        <button class="control-btn" id="theme-toggle" title="Zmie≈Ñ motyw">
                            <span class="icon">üåô</span>
                            <span class="text">Tryb ciemny</span>
                        </button>
                        
                        <!-- ‚ú® NOWY PRZYCISK ULUBIONYCH -->
                        <button class="control-btn" id="bookmarks-toggle" title="Poka≈º s≈Çowa do powt√≥rzenia">
                            <span class="icon">üîñ</span>
                            <span class="text">Powt√≥rka</span>
                            <span class="count-badge" style="display: none;">0</span>
                        </button>
                        
                        <button class="control-btn" id="stats-toggle" title="Poka≈º statystyki">
                            <span class="icon">üìä</span>
                            <span class="text">Statystyki</span>
                        </button>
                        <button class="control-btn" id="settings-toggle" title="Ustawienia">
                            <span class="icon">‚öôÔ∏è</span>
                            <span class="text">Ustawienia</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Stats Panel -->
        <div id="stats-panel" class="stats-panel">
            <div class="container">
                <div class="stats-content">
                    <h3>üìà Twoje statystyki nauki</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value" id="total-studied">0</div>
                            <div class="stat-label">Przejrzane karty</div>
                            <div class="stat-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="cards-progress"></div>
                                </div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="study-streak">0</div>
                            <div class="stat-label">Dni z rzƒôdu</div>
                            <div class="stat-icon">üî•</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="quiz-score">0%</div>
                            <div class="stat-label">≈öredni wynik quiz√≥w</div>
                            <div class="stat-icon">üéØ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="favorite-category">-</div>
                            <div class="stat-label">Ulubiona kategoria</div>
                            <div class="stat-icon">‚≠ê</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="total-words">1600+</div>
                            <div class="stat-label">Dostƒôpne s≈Çowa</div>
                            <div class="stat-icon">üìö</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="completed-categories">0/32</div>
                            <div class="stat-label">Uko≈Ñczone kategorie</div>
                            <div class="stat-icon">‚úÖ</div>
                        </div>

                        <!-- ‚ú® NOWA KARTA: Ulubione s≈Çowa -->
                        <div class="stat-card bookmark-stat-card">
                            <div class="stat-value" id="total-bookmarks-stat">0</div>
                            <div class="stat-label">S≈Çowa do powt√≥rki</div>
                            <div class="stat-icon">üîñ</div>
                            <button class="stat-action-btn" id="bookmarks-stats-btn" title="Otw√≥rz powt√≥rkƒô">
                                <span>Zobacz wszystkie</span>
                            </button>
                        </div>
                        
                        <!-- ‚ú® NOWA KARTA: Najczƒô≈õciej ulubiona kategoria -->
                        <div class="stat-card">
                            <div class="stat-value" id="top-bookmark-category">-</div>
                            <div class="stat-label">Najczƒô≈õciej ulubiona</div>
                            <div class="stat-icon">üèÜ</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <div class="container">
                <!-- Mode Selector -->
                <div class="mode-selector">
                    <button class="mode-btn active" id="flashcards-mode" data-mode="flashcards">
                        <span class="icon">üìö</span>
                        <span class="text">Fiszki</span>
                    </button>
                    <button class="mode-btn" id="quiz-mode" data-mode="quiz">
                        <span class="icon">üéØ</span>
                        <span class="text">Quizy</span>
                    </button>
                    <button class="mode-btn" id="sentences-mode" data-mode="sentences">
                        <span class="icon">üí¨</span>
                        <span class="text">Przyk≈Çady zda≈Ñ</span>
                    </button>
                </div>
                
                <div id="quick-access-panel" class="quick-access-panel">
                <h3>üöÄ Szybki dostƒôp</h3>
                <div class="quick-access-grid">
                    
                    <!-- ‚ú® Przycisk nauki tylko ulubionych -->
                    <button class="quick-access-btn bookmarks-study-btn" id="study-bookmarks-quick" 
                            title="Ucz siƒô tylko s≈Ç√≥w do powt√≥rki">
                        <div class="quick-btn-icon">üîñ</div>
                        <div class="quick-btn-content">
                            <div class="quick-btn-title">Powtarzaj zapisane s≈Çownictwo</div>
                            <div class="quick-btn-subtitle">
                                <span id="bookmarks-count-quick">0</span> s≈Ç√≥w
                            </div>
                        </div>
                    </button>
                    
                    <!-- ‚ú® Przycisk przeglƒÖdania ulubionych -->
                    <button class="quick-access-btn" id="browse-bookmarks-quick" 
                            title="PrzeglƒÖdaj wszystkie s≈Çowa do powt√≥rki">
                        <div class="quick-btn-icon">üìö</div>
                        <div class="quick-btn-content">
                            <div class="quick-btn-title">PrzeglƒÖdaj s≈Çowa do powt√≥rki</div>
                            <div class="quick-btn-subtitle">ZarzƒÖdzaj listƒÖ</div>
                        </div>
                    </button>
                    
                    <!-- ‚ú® Przycisk losowego quizu z ulubionych -->
                    <button class="quick-access-btn" id="quiz-bookmarks-quick" 
                            title="Quiz z s≈Ç√≥w do powt√≥rki">
                        <div class="quick-btn-icon">üéØ</div>
                        <div class="quick-btn-content">
                            <div class="quick-btn-title">Quiz z powt√≥rek</div>
                            <div class="quick-btn-subtitle">Test wiedzy</div>
                        </div>
                    </button>
                    
                </div>
            </div>

                <!-- Category Selector -->
                <div id="category-selector" class="category-selector">
                    <div class="category-search">
                        <input type="text" id="category-search" placeholder="üîç Szukaj kategorii..." class="search-input">
                    </div>
                    <div id="category-grid" class="category-grid">
                        <!-- Categories will be loaded dynamically -->
                    </div>
                </div>

                <!-- Quiz Selector -->
                <div id="quiz-selector" class="quiz-selector" style="display: none;">
                    <div class="quiz-sections">
                        <!-- Category Quizzes -->
                        <section class="quiz-section">
                            <h3>üéØ Quizy kategorii (15 pyta≈Ñ, zalicz 12)</h3>
                            <div id="category-quiz-grid" class="quiz-grid">
                                <!-- Category quizzes will be loaded dynamically -->
                            </div>
                        </section>

                        <!-- Mixed Quizzes -->
                        <section class="quiz-section">
                            <h3>üîÑ Quizy mieszane</h3>
                            <div class="quiz-grid">
                                <button class="quiz-card mixed-quiz" id="random-quiz-btn">
                                    <span class="quiz-icon">üé≤</span>
                                    <span class="quiz-name">Quiz losowy</span>
                                    <span class="quiz-description">20 losowych s≈Ç√≥w</span>
                                    <span class="quiz-status">Zawsze dostƒôpny</span>
                                </button>
                                
                                <!-- ZMIANA: Zaktualizuj z difficult-words na bookmarks -->
                                <button class="quiz-card mixed-quiz" id="bookmarks-quiz-btn">
                                    <span class="quiz-icon">üîñ</span>
                                    <span class="quiz-name">Quiz z powt√≥rek</span>
                                    <span class="quiz-description">S≈Çowa do powt√≥rki</span>
                                    <span class="quiz-status">Wymaga 3+ s≈Ç√≥w</span>
                                </button>
                                
                                <!-- NOWE: Dodaj nowe typy quiz√≥w -->
                                <button class="quiz-card mixed-quiz" id="speed-quiz-btn">
                                    <span class="quiz-icon">‚ö°</span>
                                    <span class="quiz-name">Quiz b≈Çyskawiczny</span>
                                    <span class="quiz-description">10 pyta≈Ñ, 30s ka≈ºde</span>
                                    <span class="quiz-status">Zawsze dostƒôpny</span>
                                </button>
                                
                                <button class="quiz-card mixed-quiz" id="mixed-quiz-btn">
                                    <span class="quiz-icon">üéØ</span>
                                    <span class="quiz-name">Quiz mieszany</span>
                                    <span class="quiz-description">Wybrane kategorie</span>
                                    <span class="quiz-status">Dostƒôpny</span>
                                </button>
                            </div>
                        </section>

                        <!-- NOWA SEKCJA: Quizy trudno≈õci -->
                        <section class="quiz-section">
                            <h3>‚≠ê Quizy poziom√≥w trudno≈õci</h3>
                            <div class="quiz-grid">
                                <button class="quiz-card difficulty-quiz easy-quiz" id="easy-words-quiz-btn">
                                    <span class="quiz-icon">‚≠ê</span>
                                    <span class="quiz-name">Quiz ≈Çatwych s≈Ç√≥w</span>
                                    <span class="quiz-description">S≈Çowa oznaczone jako ≈Çatwe</span>
                                    <span class="quiz-status" id="easy-quiz-status">Brak s≈Ç√≥w</span>
                                </button>
                                
                                <button class="quiz-card difficulty-quiz hard-quiz" id="hard-words-quiz-btn">
                                    <span class="quiz-icon">‚≠ê‚≠ê‚≠ê</span>
                                    <span class="quiz-name">Quiz trudnych s≈Ç√≥w</span>
                                    <span class="quiz-description">S≈Çowa oznaczone jako trudne</span>
                                    <span class="quiz-status" id="hard-quiz-status">Brak s≈Ç√≥w</span>
                                </button>
                                
                                <button class="quiz-card difficulty-quiz progressive-quiz" id="progressive-quiz-btn">
                                    <span class="quiz-icon">üìà</span>
                                    <span class="quiz-name">Quiz progresywny</span>
                                    <span class="quiz-description">Od ≈Çatwych do trudnych</span>
                                    <span class="quiz-status" id="progressive-quiz-status">Niedostƒôpny</span>
                                </button>
                                
                                <button class="quiz-card difficulty-quiz adaptive-quiz" id="adaptive-quiz-btn">
                                    <span class="quiz-icon">üß†</span>
                                    <span class="quiz-name">Quiz adaptacyjny</span>
                                    <span class="quiz-description">Dostosowany do Twojego poziomu</span>
                                    <span class="quiz-status" id="adaptive-quiz-status">Niedostƒôpny</span>
                                </button>
                            </div>
                        </section>

                        <!-- Final Quiz -->
                        <section class="quiz-section">
                            <h3>üèÜ Quiz ko≈Ñcowy (50 pyta≈Ñ, zalicz 42)</h3>
                            <div class="quiz-grid">
                                <button class="quiz-card final-quiz" id="final-quiz-btn">
                                    <span class="quiz-icon">üéì</span>
                                    <span class="quiz-name">Test ze wszystkich kategorii</span>
                                    <span class="quiz-description">50 pyta≈Ñ z ca≈Çego materia≈Çu</span>
                                    <span class="quiz-status" id="final-quiz-status">Niedostƒôpny</span>
                                </button>
                            </div>
                        </section>
                    </div>
                </div>

                <!-- Flashcard Container -->
                <div id="flashcard-container" class="flashcard-container">
                    <div class="flashcard-wrapper">
                        <div class="flashcard" id="flashcard">
                            <div class="card-face card-front" id="card-front">
                                <!-- Front content will be inserted here -->
                            </div>
                            <div class="card-face card-back" id="card-back">
                                <!-- Back content will be inserted here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quiz Container -->
                <div id="quiz-container" class="quiz-container" style="display: none;">
                    <div class="quiz-header">
                        <div class="quiz-info">
                            
                            <div class="quiz-controls">
                            <h3 id="quiz-title">Quiz: Build and Appearance</h3><button class="quiz-btn cancel" id="quiz-cancel-btn" title="Przerwij quiz">
                                <span class="icon">‚ùå</span>
                                <span class="text">Przerwij</span>
                            </button>
                        </div><div class="quiz-progress">
                                <span class="progress-text">
                                    Pytanie <span id="quiz-current">1</span> z <span id="quiz-total">15</span>
                                </span>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="quiz-progress-fill" style="width: 6.66667%;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- ‚ú® NOWY PRZYCISK PRZERWANIA QUIZU -->
                        

                        <div class="quiz-score">
                            <span class="score-label">Wynik:</span>
                            <span class="score-value" id="quiz-score-display">0/0</span>
                        </div>
                    </div>
                    
                    <div class="quiz-timer" id="quiz-timer" style="display: none;">
                        <span class="timer-label">Czas:</span>
                        <span class="timer-value" id="timer-value">30</span>
                        <div class="timer-bar">
                            <div class="timer-fill" id="timer-fill"></div>
                        </div>
                    </div>

                    <div class="quiz-content">
                        <div class="quiz-question-card">
                            <div class="question-section">
                                <div class="english-word" id="quiz-english-word">beautiful</div>
                                <div class="quiz-instruction">Wybierz poprawne polskie t≈Çumaczenie:</div>
                            </div>
                            
                            <!-- Multiple Choice Quiz -->
                            <div id="multiple-choice-section" class="answer-section">
                                <div class="answer-options" id="answer-options">
                                    <!-- Options will be inserted here -->
                                </div>
                            </div>
                            
                            <!-- Text Input Quiz -->
                            <div id="text-input-section" class="answer-section" style="display: none;">
                                <div class="input-group">
                                    <input type="text" id="quiz-answer-input" class="quiz-input" 
                                           placeholder="Wpisz polskie t≈Çumaczenie..." autocomplete="off">
                                    <button class="quiz-btn primary" id="quiz-submit-btn">Sprawd≈∫</button>
                                </div>
                            </div>
                            
                            <!-- Sentence Quiz -->
                            <div id="sentence-section" class="answer-section" style="display: none;">
                                <div class="sentence-question">
                                    <p class="instruction">Przet≈Çumacz zdanie:</p>
                                    <p class="sentence-text" id="sentence-to-translate"></p>
                                </div>
                                <div class="input-group">
                                    <textarea id="sentence-answer" class="sentence-input" 
                                              placeholder="Wpisz t≈Çumaczenie zdania..." rows="3"></textarea>
                                    <button class="quiz-btn primary" id="sentence-submit-btn">Sprawd≈∫</button>
                                </div>
                            </div>
                            
                            <!-- Quiz Feedback -->
                            <div id="quiz-feedback" class="quiz-feedback" style="display: none;">
                                <div class="feedback-content">
                                    <div class="feedback-icon" id="feedback-icon">‚úÖ</div>
                                    <div class="feedback-text" id="feedback-text">Poprawnie!</div>
                                    <div class="feedback-details" id="feedback-details"></div>
                                </div>
                                <div class="feedback-actions">
                                    <button class="quiz-btn primary" id="quiz-next-btn">Nastƒôpne pytanie</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quiz Results -->
                <div id="quiz-results" class="quiz-results" style="display: none;">
                    <div class="results-card">
                        <div class="results-header">
                            <div class="results-icon" id="results-icon">üéâ</div>
                            <h3 id="results-title">Gratulacje!</h3>
                        </div>
                        
                        <div class="results-content">
                            <div class="score-display">
                                <div class="score-main">
                                    <span id="results-score">12/15</span>
                                </div>
                                <div class="score-percentage" id="results-percentage">80%</div>
                            </div>
                            
                            <div class="results-status" id="results-status">
                                Quiz zaliczony!
                            </div>
                            
                            <div class="results-details" id="results-details">
                                <!-- Detailed results will be shown here -->
                            </div>
                        </div>
                        
                        <div class="results-actions">
                            <button class="quiz-btn secondary" id="quiz-retry-btn">
                                <span class="icon">üîÑ</span>
                                <span class="text">Spr√≥buj ponownie</span>
                            </button>
                            <button class="quiz-btn primary" id="quiz-continue-btn">
                                <span class="icon">‚û°Ô∏è</span>
                                <span class="text">Kontynuuj naukƒô</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Navigation Controls -->
                <div id="navigation-controls" class="navigation-controls">
                    <button class="nav-btn" id="prev-btn">
                        <span class="icon">‚¨ÖÔ∏è</span>
                        <span class="text">Poprzednia</span>
                    </button>
                    <!-- ‚ú® NOWY PRZYCISK: Tryb ulubionych -->
                    <button class="nav-btn bookmarks-mode-btn" id="bookmarks-mode-toggle" 
                            title="Prze≈ÇƒÖcz tryb nauki tylko powt√≥rka">
                        <span class="icon">üîñ</span>
                        <span class="text">Tryb powt√≥rki</span>
                    </button>
                    <button class="nav-btn primary" id="flip-btn">
                        <span class="icon">üîÑ</span>
                        <span class="text">Obr√≥ƒá fiszkƒô</span>
                    </button>
                    <button class="nav-btn" id="next-btn">
                        <span class="icon">‚û°Ô∏è</span>
                        <span class="text">Nastƒôpna</span>
                    </button>
                </div>

                <!-- Progress Display -->
                <div id="progress-display" class="progress-display">
                    <div class="progress-info">
                        <span class="progress-text">
                            Karta <span id="current-card">1</span> z <span id="total-cards">50</span>
                        </span>
                        <span class="category-name" id="current-category">Build and Appearance</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-actions">
                        <button class="action-btn" id="shuffle-btn" title="Wymieszaj karty">
                            <span class="icon">üîÄ</span>
                            <span class="text">Wymieszaj</span>
                        </button>
                        <button class="action-btn" id="reset-btn" title="Resetuj postƒôp">
                            <span class="icon">üîÑ</span>
                            <span class="text">Reset</span>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Notifications Container -->
    <div id="notifications-container" class="notifications-container" aria-live="polite" role="status"></div>

    <!-- Offline indicator -->
    <div id="offline-indicator" class="offline-indicator hidden" role="alert">
        <span class="icon" aria-hidden="true">üì∂</span>
        <span class="text">Aplikacja dzia≈Ça offline</span>
    </div>

    <!-- üîñ Modal Ulubionych S≈Ç√≥w -->
    <div id="bookmarks-modal" class="modal-overlay" style="display: none;">
        <div class="modal bookmarks-modal">
            <!-- üìã Nag≈Ç√≥wek modala -->
            <div class="modal-header">
                <div class="modal-title">
                    <span class="icon">üîñ</span>
                    <h3>Ulubione s≈Çowa</h3>
                    <span id="bookmarks-count" class="count-badge">0</span>
                </div>
                <button class="modal-close" id="bookmarks-modal-close" aria-label="Zamknij">√ó</button>
            </div>

            <!-- üìä Statystyki i kontrolki -->
            <div class="modal-controls">
                <div class="bookmark-stats">
                    <div class="stat-item">
                        <span class="label">≈ÅƒÖcznie:</span>
                        <span id="total-bookmarks" class="value">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="label">Kategorie:</span>
                        <span id="bookmark-categories" class="value">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="label">Ostatnio dodane:</span>
                        <span id="recent-bookmark" class="value">-</span>
                    </div>
                </div>

                <!-- üîß Kontrolki akcji -->
                <div class="bookmark-actions">
                    <button id="study-bookmarks-btn" class="btn primary" title="Ucz siƒô zapisanych s≈Ç√≥w">
                        <span class="icon">üìö</span>
                        <span class="text">Powtarzaj zapisane s≈Ç√≥wka</span>
                    </button>
                    <button id="export-bookmarks-btn" class="btn secondary" title="Eksportuj s≈Çowa do powt√≥rki do pliku">
                        <span class="icon">üíæ</span>
                        <span class="text">Eksportuj</span>
                    </button>
                    <button id="clear-bookmarks-btn" class="btn danger" title="Usu≈Ñ wszystkie s≈Çowa z powt√≥rek">
                        <span class="icon">üóëÔ∏è</span>
                        <span class="text">Wyczy≈õƒá</span>
                    </button>
                </div>
            </div>

            <!-- üîç Wyszukiwanie i filtrowanie -->
            <div class="modal-filters">
                <div class="search-group">
                    <input 
                        type="text" 
                        id="bookmarks-search" 
                        class="search-input" 
                        placeholder="üîç Szukaj w powt√≥rkach..."
                        autocomplete="off"
                    >
                </div>
                <div class="filter-group">
                    <select id="bookmarks-category-filter" class="filter-select">
                        <option value="">Wszystkie kategorie</option>
                    </select>
                    <select id="bookmarks-sort" class="filter-select">
                        <option value="recent">Ostatnio dodane</option>
                        <option value="alphabetical">Alfabetycznie</option>
                        <option value="category">Wed≈Çug kategorii</option>
                    </select>
                </div>
            </div>

            <!-- üìö Lista ulubionych s≈Ç√≥w -->
            <div class="modal-content bookmarks-content">
                <!-- üéØ Placeholder gdy brak ulubionych -->
                <div id="no-bookmarks-placeholder" class="placeholder">
                    <div class="placeholder-icon">üîñ</div>
                    <h4>Brak s≈Ç√≥wek do powt√≥rzenia</h4>
                    <p>Dodaj s≈Çowa do powt√≥rzenia klikajƒÖc przycisk üîñ na fiszce</p>
                    <button class="btn primary" onclick="closeBookmarksModal()">
                        <span class="text">Zacznij naukƒô</span>
                    </button>
                </div>

                <!-- üìã Lista s≈Ç√≥w -->
                <div id="bookmarks-list" class="bookmarks-list">
                    <!-- S≈Çowa bƒôdƒÖ dodawane dynamicznie przez JavaScript -->
                </div>
            </div>

            <!-- üìÑ Paginacja (je≈õli du≈ºo s≈Ç√≥w) -->
            <div id="bookmarks-pagination" class="modal-pagination" style="display: none;">
                <button id="prev-page" class="pagination-btn">‚Äπ Poprzednie</button>
                <span id="page-info" class="page-info">Strona 1 z 1</span>
                <button id="next-page" class="pagination-btn">Nastƒôpne ‚Ä∫</button>
            </div>
        </div>
    </div>

    <!-- üéØ MODAL WYBORU KATEGORII DLA QUIZ MIESZANY -->
    <div id="category-selection-modal" class="modal-overlay" style="display: none;">
        <div class="modal category-selection-modal">
            <!-- Nag≈Ç√≥wek modala -->
            <div class="modal-header">
                <div class="modal-title">
                    <span class="icon">üéØ</span>
                    <h3>Quiz Mieszany - Wybierz kategorie</h3>
                </div>
                <button class="modal-close" id="category-selection-close" aria-label="Zamknij">√ó</button>
            </div>

            <!-- Informacje o wyborze -->
            <div class="modal-info">
                <div class="selection-summary">
                    <div class="summary-item">
                        <span class="label">Wybrane kategorie:</span>
                        <span id="selected-categories-count" class="value">0</span>
                        <span class="total">/ 32</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Dostƒôpne s≈Çowa:</span>
                        <span id="selected-words-count" class="value">0</span>
                    </div>
                </div>
                
                <div class="selection-actions">
                    <button id="select-all-categories" class="btn secondary small">Zaznacz wszystkie</button>
                    <button id="deselect-all-categories" class="btn secondary small">Odznacz wszystkie</button>
                </div>
            </div>

            <!-- Lista kategorii -->
            <div class="modal-content category-selection-content">
                <div class="categories-grid" id="categories-selection-grid">
                    <!-- Kategorie bƒôdƒÖ dodane dynamicznie przez JavaScript -->
                </div>
            </div>

            <!-- Akcje -->
            <div class="modal-footer">
                <div class="footer-info">
                    <span class="requirement">Minimum 2 kategorie wymagane</span>
                </div>
                <div class="footer-actions">
                    <button id="cancel-category-selection" class="btn secondary">
                        <span class="icon">‚ùå</span>
                        <span class="text">Anuluj</span>
                    </button>
                    <button id="start-mixed-quiz" class="btn primary" disabled>
                        <span class="icon">üöÄ</span>
                        <span class="text">Uruchom Quiz</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Modules - POPRAWIONA KOLEJNO≈öƒÜ BEZ CYKLICZNYCH ZALE≈ªNO≈öCI -->
    <script>
        // Critical error handling
        window.addEventListener('error', function(e) {
            console.error('Critical error:', e.error);
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen) {
                loadingScreen.innerHTML = `
                    <div style="text-align:center;color:white;padding:20px">
                        <h2>‚ö†Ô∏è B≈ÇƒÖd ≈Çadowania</h2>
                        <p>Aplikacja nie mo≈ºe siƒô za≈Çadowaƒá. Spr√≥buj od≈õwie≈ºyƒá stronƒô.</p>
                        <button onclick="location.reload()" style="background:#1e3a8a;color:white;border:none;padding:10px 20px;border-radius:8px;margin-top:10px">
                            Od≈õwie≈º stronƒô
                        </button>
                    </div>
                `;
            }
        });

        // Performance mark
        performance.mark('app-start');
        
        console.log('üöÄ Rozpoczynam ≈Çadowanie aplikacji English Flashcards...');
    </script>
    
    <!-- 6. MAIN APPLICATION - G≈Ç√≥wna aplikacja -->
    <script type="module" src="js/app.js"></script>

    <!-- Service Worker Registration - TYLKO DLA HTTP/HTTPS 
    <script>
        if ('serviceWorker' in navigator && window.location.protocol !== 'file:') {
            window.addEventListener('load', async () => {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js', {
                        scope: '/'
                    });
                    console.log('SW registered:', registration.scope);
                    
                    // Listen for updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // New content available
                                if (window.NotificationManager) {
                                    NotificationManager.show('Nowa wersja dostƒôpna. Od≈õwie≈º stronƒô.', 'info', 0);
                                }
                            }
                        });
                    });
                } catch (error) {
                    console.log('SW registration failed:', error);
                }
            });
        }
    </script>-->
</body>
</html>